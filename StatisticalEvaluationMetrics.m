clear all
close all
clc

% VALUES FOR THE MEDIAN OF BOXPLOTS FOR EACH PATIENT FOR EACH METRIC
% with 10s windows
% EACH COLUMN CORRESPONDS TO A PATIENT (Again a better approach would be desired to extract this values )


fmdsC=[6.93789184077131,5.36259478018633,2.97186091795056,5.37283701099880,6.97927742086553,3.12725078330899,2.80468412324899,3.88873357175735,6.66542886908382,3.35502226997993,5.51804443589246,4.29072866614722,4.36559832626369,5.24392111872419,5.82700045560895,9.22213822867878,7.46388576187912,7.44775244458397,6.90080249966078,5.57717727290550,5.82474116170323,2.18699958439579,3.98073732569026,8.01930197094957,4.48123247723638];

ffsC=[2,2.50000000000000,1.50000000000000,4,6.50000000000000,2.50000000000000,2.50000000000000,1.50000000000000,6.50000000000000,2,3,1,1.50000000000000,3.50000000000000,4.50000000000000,1.50000000000000,5.50000000000000,6,2.50000000000000,2.50000000000000,2,1,1.50000000000000,1.50000000000000,1];

pwsC=[63055.0236893340,108949.098721458,375705.390102823,125003.815519377,110097.204392381,371411.525257865,369633.454484322,139390.300308075,216347.268888355,101075.970099968,57025.8604869984,219614.285486411,245440.376700490,149462.027789865,156145.963450255,55886.3430060109,90960.7881934025,89969.0858467560,90930.5924078752,168240.606308664,105553.787446854,985400.999907418,186658.493405173,50682.4983874702,58305.2495526210];

fmsF=[6.53091984724061,5.06725317859352,5.05767142233191,6.56620006966621,6.03612332153899,6.29060104157731,4.00445005915632,2.57175840355306,5.84519836723578,4.38317185605978,2.74784655131614,4.08624419389340,4.39652782885778,5.17723489725706,4.13289942722657,3.80473868075334,4.50593412739850,5.07368372326508,5.42358253437163,4.87236185038995,3.19251080569822,6.60178885334883,4.74116436948842,6.47801274977013,4.21488132852071];

ffsF=[7,4.50000000000000,4.50000000000000,5.50000000000000,4.50000000000000,5.50000000000000,3.50000000000000,2,4.50000000000000,4,1,3.50000000000000,3.50000000000000,3.50000000000000,3.50000000000000,3,4,4.50000000000000,4.50000000000000,4,3,5.50000000000000,3.50000000000000,5.50000000000000,4];

pwsF=[248766.014579998,521445.465548611,160894.830884836,42862.9189221240,223863.657733586,134217.669088500,733291.008656242,636239.354146676,584659.579854631,96189.3464094841,134366.103321265,66859.3149843530,246959.570701352,619974.675390331,725929.995788590,205041.883567615,201439.616957100,265581.004040585,227451.691278823,209924.208459514,754268.424482888,70295.3947992661,55659.0005440222,90665.4196513921,848926.915749595];

mediaNTSCSCC=[4.06666666666667,20.3333333333333,54.2000000000000,32.8666666666667,17.9333333333333,43.0666666666667,59.3333333333333,33.7333333333333,38.1333333333333,56.0666666666667,19.8666666666667,30.6666666666667,55.6000000000000,29.0666666666667,40.4666666666667,7.20000000000000,7.66666666666667,6.86666666666667,6.13333333333333,33.0666666666667,28,73.1333333333333,79.9333333333333,18.8666666666667,37.7333333333333];
mediaNTSCSCVF=[67.7333333333333,67.7333333333333,58.7333333333333,52.0666666666667,66.2666666666667,57.8666666666667,80.6666666666667,80.7333333333333,74.4000000000000,59.2000000000000,61,50.0666666666667,58,76.0666666666667,74.2666666666667,66.1333333333333,63.8000000000000,65.2000000000000,68.0666666666667,73.8000000000000,79.0666666666667,51.4666666666667,66,59.7333333333333,75.9333333333333];

mediaF1C=[0.0116284013605442,0.0159608843537415,0.0252763605442177,0.0422534013605442,0.0262202380952381,0.0247066326530612,0.0214540816326531,0.00833758503401361,0.0290603741496599,0.0353188775510204,0.0140603741496599,0.0220535714285714,0.0309481292517007,0.0300935374149660,0.0334268707482993,0.0154081632653061,0.0169770408163265,0.0240901360544218,0.0231207482993197,0.0445493197278912,0.0174192176870748,0.0132610544217687,0.0301020408163265,0.0299744897959184,0.00947704081632653];
mediaF1VF=[0.0548639455782313,0.0498214285714286,0.0500425170068027,0.0508715986394558,0.0464710884353742,0.0447321428571429,0.0474617346938775,0.0275297619047619,0.0653528911564626,0.0350255102040816,0.0220620748299320,0.0255399659863946,0.0240901360544218,0.0288690476190476,0.0522321428571429,0.0335119047619048,0.0319642857142857,0.0411139455782313,0.0499872448979592,0.0549532312925170,0.0480952380952381,0.0418324829931973,0.0340433673469388,0.0426658163265306,0.0495238095238095];

% % Xcsv=[fmdsC',fmsF',ffsC',ffsF',pwsC',pwsF',mediaNTSCSCC',mediaNTSCSCVF',mediaF1C',mediaF1VF']
% % csvwrite('5 metricas_resultados_medianas das janelas.csv',Xcsv)

% BOXPLOT VISUALIZATION

F = figure();
boxplot([fmdsC', fmsF'], {'s/VF', 'c/VF'})
title('Average Frequencies')
xlabel('ECGs:')
ylabel('f [Hz]')

FF = figure();
boxplot([ffsC', ffsF'], {'s/VF', 'c/VF'})
title('Fundamental Frequencies')
xlabel('ECGs:')
ylabel('f [Hz]')

P = figure();
boxplot([pwsC', pwsF'], {'s/VF', 'c/VF'})
title('Powers')
xlabel('ECGs:')
ylabel('W')

NT = figure();
boxplot([mediaNTSCSCC', mediaNTSCSCVF'], {'s/VF', 'c/VF'})
title('N(%) (Percentage of samples passing V0)')
xlabel('ECGs:')
ylabel('N(%)')

FI = figure();
boxplot([mediaF1C', mediaF1VF'], {'s/VF', 'c/VF'})
title('F1 RATIO')
xlabel('ECGs:')
ylabel('F1 (ratio -> black pixels/total)')


%%
% Hypothesis Testing

% AVERAGE FREQUENCIES
[pFM, hFM, statsFM] = signrank(fmdsC', fmsF');
% Since h = 0 and p = 0.1578 > 0.05, our hypothesis test failed to reject
% the null hypothesis that the difference in means between the two paired samples is 0.
% This means that the mean can be equal for both VF and non-VF, making it a metric that does not distinguish VF from non-VF.

% FUNDAMENTAL FREQUENCIES
[pFF, hFF, statsFF] = signrank(ffsC', ffsF');
% Since h = 1 and p = 0.0079 < 0.05, our hypothesis test successfully rejects
% the null hypothesis that the difference in means between the two paired samples is 0.
% This means that the mean can be different for VF and non-VF, making it a GOOD metric to distinguish VF from non-VF.

% POWER
[pPW, hPW, statsPW] = signrank(pwsC', pwsF');
% Since h = 1 and p = 0.037 < 0.05, our hypothesis test successfully rejects
% the null hypothesis that the difference in means between the two paired samples is 0.
% This means that the mean can be different for VF and non-VF, making it a GOOD metric to distinguish VF from non-VF.

% N(%) (Percentage of samples passing V0)
[pN, hN, statsN] = signrank(mediaNTSCSCC', mediaNTSCSCVF');
% Since h = 1 and p << 0.05, our hypothesis test successfully rejects
% the null hypothesis that the difference in means between the two paired samples is 0.
% This means that the mean can be different for VF and non-VF, making it a GOOD metric to distinguish VF from non-VF.

% PHASE-IMAGE
[pFI, hFI, statsFI] = signrank(mediaF1C', mediaF1VF');
% Since h = 1 and p << 0.05, our hypothesis test successfully rejects
% the null hypothesis that the difference in means between the two paired samples is 0.
% This means that the mean can be different for VF and non-VF, making it a GOOD metric to distinguish VF from non-VF.

% SUMMARY: BEST TO WORST
% 1- PHASE-IMAGE
% 2- N(%)
% 3- Fundamental Frequencies
% 4- Power
% 5- Average Frequencies (mediocre - failed to reject H0)

